---
permalink: admin/grid-federation-manage-connection.html 
sidebar: sidebar 
keywords: grid federation, edit connection, remove connection, rotate certificates 
summary: StorageGRID システム間のグリッドフェデレーション接続の管理には、接続の詳細の編集、証明書のローテーション、テナント権限の削除、未使用の接続の削除が含まれます。 
---
= グリッドフェデレーション接続を管理します
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
StorageGRID システム間のグリッドフェデレーション接続の管理には、接続の詳細の編集、証明書のローテーション、テナント権限の削除、未使用の接続の削除が含まれます。

.開始する前に
* いずれかのグリッドで、を使用してGrid Managerにサインインしておきlink:../admin/web-browser-requirements.html["サポートされている Web ブラウザ"]ます。
* サインインしているグリッドのがlink:admin-group-permissions.html["rootアクセス権限"]必要です。




== [[edit_grid_fed_connection]]グリッドフェデレーション接続を編集します

グリッドフェデレーション接続を編集するには、接続内のいずれかのグリッドのプライマリ管理ノードにサインインします。最初のグリッドに変更を加えたら、新しい検証ファイルをダウンロードして、もう一方のグリッドにアップロードする必要があります。


NOTE: 接続の編集中も、アカウントのクローンまたはグリッド間のレプリケーション要求では引き続き既存の接続設定が使用されます。最初のグリッドに対して行った編集はすべてローカルに保存されますが、2番目のグリッドにアップロード、保存、およびテストされるまでは使用されません。



=== 接続の編集を開始します

.手順
. いずれかのグリッドのプライマリ管理ノードからGrid Managerにサインインします。
. *ノード*を選択し、システム内の他のすべての管理ノードがオンラインであることを確認します。
+

NOTE: グリッドフェデレーション接続を編集すると、StorageGRID は最初のグリッドのすべての管理ノードに「候補構成」ファイルを保存しようとします。このファイルをすべての管理ノードに保存できない場合は、*[保存してテスト]*を選択すると警告メッセージが表示されます。

. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. [グリッドフェデレーション]ページの*[アクション]*メニューまたは特定の接続の詳細ページを使用して、接続の詳細を編集します。入力する内容については、を参照してくださいlink:grid-federation-create-connection.html["グリッドフェデレーション接続を作成する"]。
+
[role="tabbed-block"]
====
.[Actions]メニュー
--
.. 接続のラジオボタンを選択します。
.. [アクション]*>*[編集]*を選択します。
.. 新しい情報を入力します。


--
.詳細ページ
--
.. 接続名を選択して詳細を表示します。
.. 「 * 編集 * 」を選択します。
.. 新しい情報を入力します。


--
====
. サインインしているグリッドのプロビジョニングパスフレーズを入力します。
. [保存して続行]*を選択します。
+
新しい値は保存されますが、別のグリッドに新しい検証ファイルをアップロードするまで接続に適用されません。

. [検証ファイルのダウンロード]*を選択します。
+
後でこのファイルをダウンロードするには、接続の詳細ページに移動します。

. ダウンロードしたファイル(`_connection-name_.grid-federation`を見つけ、安全な場所に保存します。
+

CAUTION: 検証ファイルには秘密が含まれているため、安全に保存および送信する必要があります。

. [Close]*を選択して、[Grid Federation]ページに戻ります。
. [接続ステータス]*が*[編集保留中]*になっていることを確認します。
+

NOTE: 接続の編集を開始したときに接続ステータスが* Connected *以外の場合、* Pending edit *に変更されません。

. もう一方のグリッドのファイルをグリッド管理者に提供し `_connection-name_.grid-federation`ます。




=== 接続の編集を終了します

他のグリッドに検証ファイルをアップロードして、接続の編集を完了します。

.手順
. プライマリ管理ノードからGrid Managerにサインインします。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. [検証ファイルのアップロード]*を選択して、アップロードページにアクセスします。
. [検証ファイルのアップロード]*を選択します。次に、最初のグリッドからダウンロードしたファイルを参照して選択します。
. 現在サインインしているグリッドのプロビジョニングパスフレーズを入力します。
. [保存してテスト]*を選択します。
+
編集した値を使用して接続を確立できる場合は、成功のメッセージが表示されます。それ以外の場合は、エラーメッセージが表示されます。メッセージを確認し、問題があれば対処します。

. ウィザードを閉じて[Grid Federation]ページに戻ります。
. [接続ステータス]*が[接続済み]*になっていることを確認します。
. 最初のグリッドのグリッドフェデレーションページに移動し、ブラウザを更新します。[接続ステータス]*が[接続済み]*になっていることを確認します。
. 接続が確立されたら、検証ファイルのすべてのコピーを安全に削除します。




== [[TEST_GRID_FED_CONNECTION]]グリッドフェデレーション接続をテストします

.手順
. プライマリ管理ノードからGrid Managerにサインインします。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. [グリッドフェデレーション]ページの*[アクション]*メニューまたは特定の接続の詳細ページを使用して、接続をテストします。
+
[role="tabbed-block"]
====
.[Actions]メニュー
--
.. 接続のラジオボタンを選択します。
.. [アクション]*>*[テスト]*を選択します。


--
.詳細ページ
--
.. 接続名を選択して詳細を表示します。
.. [ 接続のテスト * ] を選択します。


--
====
. 接続ステータスを確認します。
+
[cols="1a,2a"]
|===
| 接続ステータス | 製品説明 


 a| 
接続済み
 a| 
両方のグリッドが接続され、正常に通信しています。



 a| 
エラー
 a| 
接続にエラーが発生しています。たとえば、証明書の有効期限が切れているか、設定値が無効になっている場合などです。



 a| 
編集を保留中です
 a| 
このグリッドで接続を編集しましたが、接続は既存の設定を使用しています。編集を完了するには、新しい検証ファイルをもう一方のグリッドにアップロードします。



 a| 
接続を待機しています
 a| 
このグリッドで接続が設定されていますが、もう一方のグリッドでは接続が完了していません。このグリッドから検証ファイルをダウンロードし、別のグリッドにアップロードします。



 a| 
不明
 a| 
接続の状態が不明です。ネットワーク問題 またはオフラインノードが原因である可能性があります。

|===
. 接続ステータスが*エラー*の場合は、問題を解決します。次に、もう一度*[Test connection]*を選択して、問題 が修正されたことを確認します。




== [[rotate_grid_fed_certificates]接続証明書のローテーション

各グリッドフェデレーション接続は、自動生成された4つのSSL証明書を使用して接続を保護します。各グリッドの2つの証明書が有効期限に近づくと、* Expiration of grid federation certificate *アラートによって証明書のローテーションを促すメッセージが表示されます。


CAUTION: 接続のいずれかの側の証明書が期限切れになると、接続は動作を停止し、証明書が更新されるまでレプリケーションは保留になります。

.手順
. いずれかのグリッドのプライマリ管理ノードからGrid Managerにサインインします。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. [Grid Federation]ページのいずれかのタブで、接続名を選択して詳細を表示します。
. ［*証明書*］タブを選択します。
. [証明書の回転]*を選択します。
. 新しい証明書を有効にする日数を指定します。
. サインインしているグリッドのプロビジョニングパスフレーズを入力します。
. [証明書の回転]*を選択します。
. 必要に応じて、接続のもう一方のグリッドで上記の手順を繰り返します。
+
一般に、接続の両側の証明書には同じ日数を使用します。





== [[remove_grid_fed_connection]]グリッドフェデレーション接続を削除します

接続のいずれかのグリッドからグリッドフェデレーション接続を削除できます。次の図に示すように、両方のグリッドで前提条件となる手順を実行して、どちらのグリッドのテナントでも接続が使用されていないことを確認する必要があります。

image::../media/grid-federation-remove-connection.png[グリッドフェデレーション接続を削除する手順]

接続を削除する前に、次の点に注意してください。

* 接続を削除しても、グリッド間ですでにコピーされている項目は削除されません。たとえば、テナントの権限が削除されても、両方のグリッドに存在するテナントユーザ、グループ、およびオブジェクトはどちらのグリッドからも削除されません。これらのアイテムを削除する場合は、両方のグリッドから手動で削除する必要があります。
* 接続を削除すると、レプリケーションを保留している（取り込まれたがもう一方のグリッドにまだレプリケートされていない）オブジェクトのレプリケーションが永続的に失敗します。




=== すべてのテナントバケットでレプリケーションを無効にします

.手順
. いずれかのグリッドから、プライマリ管理ノードからGrid Managerにサインインします。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. 接続名を選択して詳細を表示します。
. [Permitted Tenants]*タブで、接続がテナントで使用されているかどうかを確認します。
. テナントが表示されている場合は、すべてのテナントに、接続内の両方のグリッドですべてのバケットを使用するように指示しlink:../tenant/grid-federation-manage-cross-grid-replication.html["グリッド間レプリケーションを無効にします"]ます。
+

TIP: テナントバケットでグリッド間レプリケーションが有効になっている場合は、* Use grid federation connection *権限を削除することはできません。各テナントアカウントは、両方のグリッドでバケットのグリッド間レプリケーションを無効にする必要があります。





=== 各テナントの権限を削除します

すべてのテナントバケットでグリッド間レプリケーションを無効にしたら、両方のグリッドのすべてのテナントから* Use grid federation permission *を削除します。

.手順
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. 接続名を選択して詳細を表示します。
. 各テナントについて、*[Permitted Tenants]*タブで、各テナントから*[Use Grid Federation connection]*権限を削除します。を参照して link:grid-federation-manage-tenants.html["許可されたテナントを管理する"]
. もう一方のグリッドで許可されたテナントについて、上記の手順を繰り返します。




=== 接続を削除します

.手順
. どちらのグリッドでも接続を使用しているテナントがない場合は、*[削除]*を選択します。
. 確認メッセージを確認し、*[削除]*を選択します。
+
** 接続を削除できる場合は、成功を示すメッセージが表示されます。これで、グリッドフェデレーション接続が両方のグリッドから削除されます。
** 接続を削除できない場合（まだ使用中、接続エラーなど）、エラーメッセージが表示されます。次のいずれかを実行できます。
+
*** エラーを解決します（推奨）。を参照して link:grid-federation-troubleshoot.html["グリッドフェデレーションエラーをトラブルシューティングする"]
*** 力で接続を取り外します。次のセクションを参照してください。








== [[force-remove_grid_fed_connection]]グリッドフェデレーション接続を強制的に削除します

必要に応じて、ステータスが*connected*でない接続を強制的に削除できます。

強制的に削除すると、ローカルグリッドからのみ接続が削除されます。接続を完全に削除するには、両方のグリッドで同じ手順を実行します。

.手順
. 確認ダイアログボックスで*[強制削除]*を選択します。
+
成功を示すメッセージが表示されます。このグリッドフェデレーション接続は使用できなくなります。ただし、テナントバケットでグリッド間レプリケーションが引き続き有効になっている場合や、接続内のグリッド間で一部のオブジェクトコピーがすでにレプリケートされている場合があります。

. 接続のもう一方のグリッドで、プライマリ管理ノードからGrid Managerにサインインします。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. 接続名を選択して詳細を表示します。
. *[削除]*および*[はい]*を選択します。
. このグリッドから接続を削除するには、*[強制削除]*を選択します。

