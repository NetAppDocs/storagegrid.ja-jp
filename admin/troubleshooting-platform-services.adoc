---
permalink: admin/troubleshooting-platform-services.html 
sidebar: sidebar 
keywords: troubleshoot platform services, platform services endpoint error 
summary: プラットフォームサービスで使用されるエンドポイントは、テナントユーザが Tenant Manager で作成および管理します。ただし、テナントでプラットフォームサービスの設定または使用に関する問題がテナントで発生した場合は、グリッドマネージャを使用して問題 を解決できる可能性があります。 
---
= プラットフォームサービスのトラブルシューティングを行う
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
プラットフォームサービスで使用されるエンドポイントは、テナントユーザが Tenant Manager で作成および管理します。ただし、テナントでプラットフォームサービスの設定または使用に関する問題がテナントで発生した場合は、グリッドマネージャを使用して問題 を解決できる可能性があります。



== 新しいエンドポイントに関する問題

テナントでプラットフォームサービスを使用するには、 Tenant Manager を使用してエンドポイントを 1 つ以上作成する必要があります。各エンドポイントは、1つのプラットフォームサービスの外部のデスティネーション（StorageGRID S3バケット、Amazon Web Servicesバケット、Amazon Simple Notification Serviceトピック、Kafkaトピック、ローカルまたはAWSでホストされるElasticsearchクラスタなど）です。各エンドポイントには、外部リソースの場所と、そのリソースへのアクセスに必要なクレデンシャルが含まれます。

テナントでエンドポイントを作成すると、 StorageGRID システムによって、そのエンドポイントが存在するかどうかと、指定されたクレデンシャルでアクセスできるかどうかが検証されます。エンドポイントへの接続は、各サイトの 1 つのノードから検証されます。

エンドポイントの検証が失敗した場合は、その理由を記載したエラーメッセージが表示されます。テナントユーザは、問題 を解決してから、エンドポイントの作成をもう一度実行する必要があります。


NOTE: テナントアカウントでプラットフォームサービスが有効になっていないと、エンドポイントの作成が失敗します。



== 既存のエンドポイントに関する問題

StorageGRID が既存のエンドポイントにアクセスしようとしたときにエラーが発生すると、テナントマネージャのダッシュボードにメッセージが表示されます。

image::../media/tenant_dashboard_endpoint_error.png[ダッシュボードのエンドポイントエラーメッセージ]

テナントユーザは、エンドポイントページに移動して各エンドポイントの最新のエラーメッセージを確認し、エラーが発生してからの時間を特定できます。[* Last error*] 列には、各エンドポイントの最新のエラーメッセージとエラーが発生してからの経過時間が表示されます。アイコンを含むエラーがimage:../media/icon_alert_red_critical.png["赤い X 印のアイコン"]過去7日以内に発生しました。

image::../media/endpoints_last_error.png[Last Error 列を示すエンドポイントページのスクリーンショット]


NOTE: 「 * Last error * 」列の一部のエラーメッセージには、かっこ内にログ ID が含まれている場合があります。グリッド管理者やテクニカルサポートは、この ID を使用して、 bycast.log のエラーに関する詳細情報を確認できます。



== プロキシサーバに関連する問題

ストレージノードとプラットフォームサービスエンドポイントの間にを設定している場合link:configuring-storage-proxy-settings.html["ストレージプロキシ"]、プロキシサービスでStorageGRIDからのメッセージが許可されていないとエラーが発生する可能性があります。これらの問題を解決するには、プロキシサーバーの設定をチェックして、プラットフォームサービス関連のメッセージがブロックされていないことを確認してください。



== エラーが発生したかどうかを確認します

過去7日以内にエンドポイントエラーが発生した場合は、Tenant Managerのダッシュボードにアラートメッセージが表示されます。エラーの詳細を確認するには、エンドポイントのページに移動します。



== クライアント処理が失敗する

一部のプラットフォームサービスの問題により、 S3 バケットに対する原因 クライアント処理が失敗することがあります。たとえば、内部の Replicated State Machine （ RSM ）サービスが停止した場合や、配信のためにキューに登録されたプラットフォームサービスメッセージが多すぎる場合は、 S3 クライアント処理が失敗します。

サービスのステータスを確認するには、次の手順に従います。

. サポート * > * ツール * > * グリッドトポロジ * を選択します。
. [*_site *>*_Storage Node_*>*SSM*>*Services] を選択します。




== リカバリ可能なエンドポイントエラーとリカバリ不能なエンドポイントエラー

エンドポイントの作成後に、さまざまな理由からプラットフォームサービス要求のエラーが発生することがあります。一部のエラーは、ユーザが対処することでリカバリできます。たとえば、リカバリ可能なエラーは次のような原因で発生する可能性があります。

* ユーザのクレデンシャルが削除されたか、期限切れになっています。
* デスティネーションバケットが存在しません。
* 通知を配信できません。


StorageGRID でリカバリ可能なエラーが発生した場合は、成功するまでプラットフォームサービス要求が再試行されます。

その他のエラーはリカバリできません。たとえば、エンドポイントが削除されるとリカバリ不能なエラーが発生します。

StorageGRIDでリカバリ不能なエンドポイントエラーが発生した場合は、次の手順を実行します。

* Grid Managerで、*サポート*>*ツール*>*メトリクス*>* Grafana *>*プラットフォームサービスの概要*に移動してエラーの詳細を確認します。
* Tenant Managerで、* storage（S3）*>* Platform Services Endpoints *の順に移動してエラーの詳細を確認します。
* に関連するエラーがないかを確認します `/var/local/log/bycast-err.log`。このログファイルは、ADCサービスがあるストレージノードに格納されます。




== プラットフォームサービスメッセージを配信できません

デスティネーションでプラットフォームサービスメッセージの受信を妨げる問題 が検出された場合、バケットに対する処理は成功しますが、プラットフォームサービスメッセージは配信されません。たとえば、デスティネーションでクレデンシャルが更新されたため StorageGRID がデスティネーションサービスを認証できなくなった場合に、このエラーが発生することがあります。

関連するアラートを確認します。



== プラットフォームサービス要求のパフォーマンスが低下します

要求が送信されるペースがデスティネーションエンドポイントで要求を受信できるペースを超えると、 StorageGRID ソフトウェアはバケットの受信 S3 要求を調整する場合があります。スロットルは、デスティネーションエンドポイントへの送信を待機している要求のバックログが生じている場合にのみ発生します。

明らかな影響は、受信 S3 要求の実行時間が長くなることだけです。パフォーマンスが大幅に低下していることが検出されるようになった場合は、取り込み速度を下げるか、容量の大きいエンドポイントを使用する必要があります。要求のバックログが増え続けると、クライアント S3 処理（ PUT 要求など）が失敗します。

通常、 CloudMirror 要求には、検索統合やイベント通知の要求よりも多くのデータ転送が含まれるため、デスティネーションエンドポイントのパフォーマンスによる影響を受ける可能性が高くなります。



== プラットフォームサービス要求が失敗しました

プラットフォームサービスの要求の失敗率を表示するには、次の手順を実行します。

. [* nodes （ノード） ] を選択します
. [*_site *>*Platform Services*] を選択します。
. エラー率のリクエストチャートを表示します。
+
image::../media/nodes_page_site_level_platform_services.gif[Nodes ページサイトレベルのプラットフォームサービス]





== Platform services unavailable アラート

「 * Platform services unavailable * 」アラートは、実行中または使用可能な RSM サービスがあるストレージノードが少なすぎるために、サイトでプラットフォームサービスの処理を実行できないことを示しています。

RSM サービスは、プラットフォームサービス要求がそれぞれのエンドポイントに確実に送信されるようにします。

このアラートを解決するには、サイトのどのストレージノードに RSM サービスが含まれているかを特定します（RSMサービスは、ADCサービスを含むストレージノードにあります）。次に、それらのストレージノードの過半数が実行されていて使用可能であることを確認します。


NOTE: RSM サービスを含む複数のストレージノードでサイトで障害が発生すると、そのサイトに対する保留中のプラットフォームサービス要求はすべて失われます。



== プラットフォームサービスエンドポイントに関するその他のトラブルシューティングガイダンス

詳細については、を参照してくださいlink:../tenant/troubleshooting-platform-services-endpoint-errors.html["テナントアカウントの使用>プラットフォームサービスエンドポイントのトラブルシューティング"]。

.関連情報
link:../troubleshoot/index.html["StorageGRID システムのトラブルシューティングを行う"]
