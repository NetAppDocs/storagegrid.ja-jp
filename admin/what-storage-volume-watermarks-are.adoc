---
permalink: admin/what-storage-volume-watermarks-are.html 
sidebar: sidebar 
keywords: what are storage volume watermarks, storage volume soft read-only watermark, storage volume hard read-only watermark, storage volume read-write watermark 
summary: StorageGRID では、ストレージボリュームのウォーターマークを 3 つ使用して、スペースの深刻な低下を発生させる前にストレージノードを読み取り専用状態に安全に移行し、読み取り専用状態に移行して再び読み取り / 書き込み可能にすることができます。 
---
= ストレージボリュームのウォーターマークとは何ですか？
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
StorageGRID では、ストレージボリュームのウォーターマークを 3 つ使用して、スペースの深刻な低下を発生させる前にストレージノードを読み取り専用状態に安全に移行し、読み取り専用状態に移行して再び読み取り / 書き込み可能にすることができます。

image::../media/storage_volume_watermarks.png[ストレージボリュームのウォーターマーク]


NOTE: ストレージボリュームのウォーターマークは、レプリケートオブジェクトデータとイレイジャーコーディングオブジェクトデータに使用されるスペースにのみ適用されます。ボリューム0でオブジェクトメタデータ用にリザーブされているスペースの詳細については、を参照してくださいlink:managing-object-metadata-storage.html["オブジェクトメタデータストレージを管理する"]。



== 読み取り専用ソフトウォーターマークとは何ですか？

ストレージボリュームのソフト読み取り専用ウォーターマーク*は、オブジェクトデータに使用可能なストレージノードのスペースがフルに近づいていることを示す最初のウォーターマークです。

ストレージノード内の各ボリュームの空きスペースがそのボリュームのソフト読み取り専用ウォーターマークよりも少ない場合、ストレージノードは_読み取り専用モード_に移行します。読み取り専用モードでは、ストレージノードは StorageGRID システムの他の要素にサービスが読み取り専用であることをアドバタイズしますが、保留中の書き込み要求はすべて実行します。

たとえば、ストレージノード内の各ボリュームのソフト読み取り専用ウォーターマークが10GBであるとします。各ボリュームの空きスペースが 10GB 未満になると、ストレージノードはソフト読み取り専用モードに移行します。



== 読み取り専用ハードウォーターマークとは何ですか？

次のウォーターマークは* storage volume hard read-only watermark *です。これは、オブジェクトデータに使用可能なノードのスペースがフルに近づいていることを示します。

ボリュームの空きスペースがそのボリュームの読み取り専用ハードウォーターマークよりも小さい場合、ボリュームへの書き込みは失敗します。ただし、他のボリュームへの書き込みは、それらのボリュームの空きスペースが読み取り専用ハードウォーターマークよりも少なくなるまで続行できます。

たとえば、ストレージノード内の各ボリュームの読み取り専用ハードウォーターマークが5GBであるとします。各ボリュームの空きスペースが 5GB 未満になると、ストレージノードは書き込み要求を受け付けなくなります。

ハード読み取り専用透かしは、常にソフト読み取り専用透かしより小さくなります。



== 読み取り/書き込みウォーターマークとは何ですか。

ストレージボリュームの読み取り/書き込みウォーターマーク*は、読み取り専用モードに移行したストレージノードにのみ適用されます。また、ノードが再度読み取り / 書き込み可能になるタイミングを決定します。ストレージノード内のいずれかのストレージボリュームの空きスペースがそのボリュームの読み取り/書き込みウォーターマークを超えると、ノードは自動的に読み取り/書き込み状態に戻ります。

たとえば、ストレージノードが読み取り専用モードに移行したとします。また、各ボリュームの読み取り/書き込みウォーターマークが30GBであるとします。ボリュームの空きスペースが 30GB に増えると、そのノードは再び読み取り / 書き込み可能になります。

読み取り/書き込みウォーターマークは、ソフト読み取り専用ウォーターマークとハード読み取り専用ウォーターマークの両方より常に大きくなります。



== ストレージボリュームのウォーターマークを表示する

現在のウォーターマーク設定とシステムに最適化された値を表示できます。最適化された透かしが使用されていない場合は、設定を調整できるかどうかを判断できます。

.開始する前に
* StorageGRID 11.6以降へのアップグレードが完了している。
* Grid Managerにサインインしておきますlink:../admin/web-browser-requirements.html["サポートされている Web ブラウザ"]。
* あなたはを持っていますlink:admin-group-permissions.html["rootアクセス権限"]。




=== 現在の透かし設定を表示します

Grid Manager で、現在のストレージのウォーターマーク設定を表示できます。

.手順
. * support *>* other *>* Storage watermark *を選択します。
. [Storage Watermarks]ページで、[Use optimized values]チェックボックスを確認します。
+
** このチェックボックスをオンにすると、ストレージノードのサイズとボリュームの相対容量に基づいて、すべてのストレージノードのすべてのストレージボリュームに対して3つのウォーターマークがすべて最適化されます。
+
これがデフォルトで推奨される設定です。これらの値は更新しないでください。必要に応じて、可能です<<view-optimized-storage-watermarks,最適化されたストレージウォーターマークを表示する>>。

** [最適化された値を使用]チェックボックスがオフの場合、カスタム（最適化されていない）ウォーターマークが使用されます。カスタム透かし設定の使用はお勧めしません。の手順に従って、link:../troubleshoot/troubleshoot-low-watermark-alert.html["ロー読み取り専用のウォーターマーク上書きアラートのトラブルシューティング"]設定を調整できるかどうか、または調整する必要があるかどうかを確認します。
+
カスタムウォーターマーク設定を指定する場合は、0より大きい値を入力する必要があります。







=== [[view-optimized-storage-watermarks]]最適化されたストレージウォーターマークの表示

StorageGRIDでは、2つのPrometheus指標を使用して、ストレージボリュームのソフト読み取り専用ウォーターマークに対して計算された最適化された値が表示されます。グリッド内の各ストレージノードの最適化された最小値と最大値を表示できます。

. [*support*>] 、 [*Tools] 、 [*Metrics] の順に選択します。
. Prometheus セクションで、 Prometheus ユーザインターフェイスへのリンクを選択します。
. 推奨されるソフト読み取り専用の最小ウォーターマークを確認するには、次の Prometheus 指標を入力し、 * Execute * を選択します。
+
`storagegrid_storage_volume_minimum_optimized_soft_readonly_watermark`

+
最後の列には、各ストレージノードのすべてのストレージボリュームについて、ソフト読み取り専用ウォーターマークの最適化された最小値が表示されます。この値がストレージボリュームのソフト読み取り専用ウォーターマークのカスタム設定よりも大きい場合は、ストレージノードに対して* Low read-only watermark override *アラートがトリガーされます。

. 推奨されるソフト読み取り専用の最大ウォーターマークを確認するには、次の Prometheus 指標を入力し、 * Execute * を選択します。
+
`storagegrid_storage_volume_maximum_optimized_soft_readonly_watermark`

+
最後の列には、各ストレージノード上のすべてのストレージボリュームについて、ソフト読み取り専用ウォーターマークの最適化された最大値が表示されます。


