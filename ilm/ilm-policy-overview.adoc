---
permalink: ilm/ilm-policy-overview.html 
sidebar: sidebar 
keywords: ILM policy, information lifecycle policy considerations 
summary: 情報ライフサイクル管理（ ILM ）ポリシーは、優先順位が付けられた一連の ILM ルールです。このポリシーによって、 StorageGRID システムが時間の経過に伴ってオブジェクトデータを管理する方法が決まります。 
---
= ILMポリシーを使用する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
情報ライフサイクル管理（ ILM ）ポリシーは、優先順位が付けられた一連の ILM ルールです。 StorageGRID システムが時間の経過に伴ってオブジェクトデータを管理する方法を決定します。


CAUTION: ILM ポリシーが正しく設定されていないと、リカバリできないデータ損失が発生する可能性があります。ILM ポリシーをアクティブ化する前に、 ILM ポリシーおよびその ILM ルールを慎重に確認し、次に ILM ポリシーをシミュレートします。ILM ポリシーが意図したとおりに機能することを必ず確認してください。



== デフォルトのILMポリシー

StorageGRIDをインストールしてサイトを追加すると、次のようにデフォルトのILMポリシーが自動的に作成されます。

* グリッドにサイトが1つある場合、デフォルトのポリシーには、そのサイトの各オブジェクトのコピーを2つレプリケートするデフォルトルールが含まれています。
* グリッドに複数のサイトが含まれている場合、デフォルトルールは各サイトに各オブジェクトのコピーを1つレプリケートします。


デフォルトのポリシーがストレージ要件を満たしていない場合は、独自のルールとポリシーを作成できます。見るlink:what-ilm-rule-is.html["ILMルールを作成する"]そしてlink:creating-ilm-policy.html["ILMポリシーを作成します"]。



== 1つまたは複数のアクティブなILMポリシー

一度に1つ以上のアクティブなILMポリシーを含めることができます。



=== 1つのポリシー

グリッドでシンプルなデータ保護方式を使用し、テナント固有およびバケット固有のルールをいくつか設定する場合は、1つのアクティブなILMポリシーを使用します。ILMルールにフィルタを含めることで、さまざまなバケットやテナントを管理できます。

image::../media/ilm-policies-single.png[単一のILMポリシーの図]

ポリシーが1つしかなく、テナントの要件が変更された場合は、新しいILMポリシーを作成するか、既存のポリシーのクローンを作成して変更を適用し、シミュレートしてから新しいILMポリシーをアクティブ化する必要があります。ILMポリシーを変更すると、オブジェクトの移動に何日もかかることがあり、原因システムのレイテンシも発生する可能性があります。



=== 複数のポリシー

テナントに異なるQoSオプションを提供するために、一度に複数のアクティブポリシーを設定できます。各ポリシーでは、特定のテナント、S3バケット、オブジェクトを管理できます。特定のテナントまたはオブジェクトセットに対して1つのポリシーを適用または変更しても、他のテナントやオブジェクトに適用されているポリシーは影響を受けません。

ILMポリシータグ:: テナントで複数のデータ保護ポリシーをバケット単位で簡単に切り替えられるようにするには、_ILMポリシータグ_を指定して複数のILMポリシーを使用します。各ILMポリシーをタグに割り当て、テナントがバケットにタグを付けてそのバケットにポリシーを適用します。ILMポリシータグはS3バケットにのみ設定できます。
+
--
たとえば、Gold、Silver、Bronzeという3つのタグがあるとします。オブジェクトを格納する期間と場所に基づいて、各タグにILMポリシーを割り当てることができます。テナントでは、バケットにタグを付けることで、使用するポリシーを選択できます。Goldタグが付けられたバケットはGoldポリシーで管理され、Goldレベルのデータ保護とパフォーマンスを受け取ります。

--



NOTE: あなたはできるlink:../ilm/creating-ilm-policy.html#activate-ilm-policy["最大10個のポリシータグを作成する"]グリッド用です。

デフォルトのILMポリシータグ:: デフォルトのILMポリシータグは、StorageGRIDのインストール時に自動的に作成されます。各グリッドには、デフォルトタグに割り当てられたアクティブポリシーが1つ必要です。デフォルトポリシーは、タグなしのS3バケットに適用されます。


image::../media/ilm-policies-tags-conceptual.png[複数のILMポリシーの図]



== ILM ポリシーによるオブジェクトの評価方法

アクティブなILMポリシーは、オブジェクトの配置、期間、データ保護を制御します。

クライアントがオブジェクトをStorageGRIDに保存すると、ポリシー内の順序付けられた一連のILMルールに照らしてオブジェクトが次のように評価されます。

. ポリシー内の最初のルールのフィルタがオブジェクトに一致すると、オブジェクトはそのルールの取り込み動作に従って取り込まれ、そのルールの配置手順に従って格納されます。
. 最初のルールのフィルタがオブジェクトに一致しない場合、オブジェクトはポリシー内の後続の各ルールに照らして（一致するまで）評価されます。
. どのルールもオブジェクトに一致しない場合は、ポリシー内のデフォルトルールの取り込み動作と配置手順が適用されます。デフォルトルールは、ポリシー内の最後のルールです。デフォルトルールは、すべてのテナント、すべてのS3バケット、およびすべてのオブジェクトバージョンに適用する必要があり、高度なフィルタは使用できません。




== ILM ポリシーの例

たとえば、ILMポリシーに次の情報を指定する3つのILMルールを含めることができます。

* *ルール1：テナントAのレプリケートコピー*
+
** テナントAに属するすべてのオブジェクトを一致します
** これらのオブジェクトを3つのサイトに3つのレプリケートコピーとして格納します。
** 他のテナントに属するオブジェクトはルール1に一致しないため、ルール2に照らして評価されます。


* *ルール2：1MBを超えるオブジェクトのイレイジャーコーディング*
+
** 他のテナントのすべてのオブジェクトが一致します（1MBを超える場合にのみ一致します）。これらのオブジェクトは、 3 つのサイトで 6+3 のイレイジャーコーディングを使用して格納されます。
** は1MB以下のオブジェクトに一致しないため、これらのオブジェクトはルール3に照らして評価されます。


* *ルール3：2つのデータセンターに2つのコピーを作成*（デフォルト）
+
** は、ポリシー内の最後のデフォルトルールです。フィルタを使用しません。
** ルール1またはルール2に一致しないすべてのオブジェクト（テナントAに属していない1MB以下のオブジェクト）のレプリケートコピーを2つ作成します。




image::../media/ilm_policy_and_rules.png[ILM のポリシーとルール]



== アクティブポリシーと非アクティブポリシーとは何ですか。

すべてのStorageGRIDシステムには、アクティブなILMポリシーが少なくとも1つ必要です。複数のアクティブなILMポリシーが必要な場合は、ILMポリシータグを作成し、各タグにポリシーを割り当てます。テナントはS3バケットにタグを適用します。デフォルトポリシーは、ポリシータグが割り当てられていないバケット内のすべてのオブジェクトに適用されます。

ILMポリシーを初めて作成するときは、1つ以上のILMルールを選択して特定の順序に並べます。ポリシーをシミュレートして動作を確認したら、ポリシーをアクティブ化します。

1つのILMポリシーをアクティブ化すると、StorageGRIDはそのポリシーを使用して、既存のオブジェクトと新しく取り込まれるオブジェクトを含むすべてのオブジェクトを管理します。新しいポリシーの ILM ルールが実装されたときに、既存のオブジェクトが新しい場所に移動されることがあります。

一度に複数のILMポリシーをアクティブ化し、テナントがS3バケットにポリシータグを適用する場合、各バケット内のオブジェクトはタグに割り当てられたポリシーに従って管理されます。

StorageGRIDシステムは、アクティブ化または非アクティブ化されたポリシーの履歴を追跡します。



== ILM ポリシーの作成に関する考慮事項

* システム提供のポリシーであるBaseline 2 Copiesポリシーは、テストシステムでのみ使用してください。StorageGRID 11.6以前の場合、このポリシーのMake 2 Copiesルールでは、すべてのサイトが含まれるAll Storage Nodesストレージプールを使用します。StorageGRID システムに複数のサイトがある場合は、 1 つのオブジェクトのコピーが同じサイトに 2 つ配置される可能性があります。
+

NOTE: All Storage Nodesストレージプールは、StorageGRID 11.6以前のインストール時に自動的に作成されます。新しいバージョンのStorageGRID にアップグレードしても、All Storage Nodesプールは引き続き存在します。StorageGRID 11.7以降を新規インストールとしてインストールする場合、All Storage Nodesプールは作成されません。

* 新しいポリシーを設計する際には、グリッドに取り込まれる可能性のあるさまざまなタイプのオブジェクトをすべて考慮してください。それらのオブジェクトに一致し、必要に応じて配置するルールがポリシーに含まれていることを確認してください。
* ILM ポリシーはできるだけシンプルにします。これにより、時間が経って StorageGRID システムに変更が加えられ、オブジェクトデータが意図したとおりに保護されないという危険な状況を回避できます。
* ポリシー内のルールの順序が正しいことを確認してください。ポリシーをアクティブ化すると、新規および既存のオブジェクトがリスト内の順にルールによって評価されます。たとえば、ポリシー内の最初のルールがオブジェクトに一致した場合、そのオブジェクトは他のルールによって評価されません。
* すべてのILMポリシーの最後のルールはデフォルトのILMルールであり、フィルタは使用できません。オブジェクトが別のルールに一致していない場合は、デフォルトルールによって、そのオブジェクトの配置場所と保持期間が制御されます。
* 新しいポリシーをアクティブ化する前に、ポリシーによって既存のオブジェクトの配置が変更されていないかどうかを確認します。既存のオブジェクトの場所を変更すると、新しい配置が評価されて実装される際に一時的なリソースの問題が発生する可能性があります。

