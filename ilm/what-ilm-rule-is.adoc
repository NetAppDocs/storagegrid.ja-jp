---
permalink: ilm/what-ilm-rule-is.html 
sidebar: sidebar 
keywords: what is information lifecycle rule, ilm rule 
summary: オブジェクトを管理するには、一連の情報ライフサイクル管理（ ILM ）ルールを作成して 1 つの ILM ポリシーにまとめます。 
---
= ILMルールを使用したオブジェクトの管理
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
オブジェクトを管理するには、一連の情報ライフサイクル管理（ ILM ）ルールを作成して 1 つの ILM ポリシーにまとめます。

システムに取り込まれたすべてのオブジェクトがアクティブポリシーに照らして評価されます。ポリシー内のルールがオブジェクトのメタデータに一致すると、ルールの説明によって、 StorageGRID がそのオブジェクトをコピーして格納するために実行するアクションが決まります。


NOTE: オブジェクトメタデータはILMルールで管理されません。代わりに、オブジェクトメタデータはメタデータストア内の Cassandra データベースに格納されます。データを損失から保護するために、オブジェクトメタデータの 3 つのコピーが各サイトで自動的に維持されます。



== ILM ルールの要素

ILM ルールには次の 3 つの要素があります。

* * フィルタ条件 * ：ルールの基本フィルタと高度なフィルタにより、ルール環境 で使用するオブジェクトが定義されます。オブジェクトがすべてのフィルタに一致する場合、 StorageGRID はルールを適用し、ルールの配置手順で指定されたオブジェクトコピーを作成します。
* * 配置手順 * ：ルールの配置手順によって、オブジェクトコピーの数、タイプ、および場所が定義されます。各ルールに一連の配置手順を含めることで、時間の経過に伴うオブジェクトコピーの数、タイプ、場所を変更することができます。1 つの配置の期間が終了すると、次の配置手順が次の ILM 評価で自動的に適用されます。
* *取り込み動作*：ルールの取り込み動作により、ルールでフィルタされたオブジェクトを取り込み時に保護する方法を選択できます（S3クライアントがオブジェクトをグリッドに保存する場合）。




== ILMルールのフィルタリング

ILM ルールを作成する際には、フィルタを指定して環境 ルールを構成するオブジェクトを特定します。

最も単純なケースは、ルールでフィルタを使用しない場合です。環境 のすべてのオブジェクトでフィルタを使用しないルールがある場合は、 ILM ポリシーの最後の（デフォルト）ルールである必要があります。デフォルトルールでは、別のルールのフィルタに一致しないオブジェクトの格納手順が指定されます。

* 基本フィルタを使用すると、大規模なオブジェクトグループに異なるルールを適用できます。これらのフィルタを使用して、特定のテナントアカウント、特定のS3バケット、またはその両方にルールを適用できます。
+
基本フィルタを使用すると、多数のオブジェクトに異なるルールを簡単に適用できます。たとえば、会社の財務記録は規制要件を満たすために保存し、マーケティング部門のデータは日々の業務を円滑に進めるために保存しなければならない場合があります。部門ごとに別々のテナントアカウントを作成するか、またはデータを部門ごとに別々の S3 バケットに分離したあとで、すべての財務記録を環境 で処理するルールを 1 つ作成し、環境 ですべてのマーケティングデータを処理するもう 1 つのルールを作成することができます。

* 高度なフィルタにより、きめ細かな制御が可能になります。次のオブジェクトプロパティに基づいてオブジェクトを選択するフィルタを作成できます。
+
** 取り込み時間
** 最終アクセス時間
** オブジェクト名のすべてまたは一部（キー）
** 場所の制約（S3のみ）
** オブジェクトのサイズ
** ユーザメタデータ
** オブジェクトタグ（S3のみ）




非常に特定の条件でオブジェクトをフィルタリングできます。たとえば、病院の画像診断部門が保管するオブジェクトは、 30 日以内に頻繁に使用され、その後はあまり使用されない可能性があります。一方、患者の通院情報を格納するオブジェクトは、医療ネットワークの本部請求部門にコピーする必要があります。オブジェクト名、サイズ、 S3 オブジェクトタグ、またはその他の関連条件に基づいて各タイプのオブジェクトを識別するフィルタを作成してから、それぞれのオブジェクトセットを適切に格納するルールを別々に作成できます。

1つのルールで必要に応じてフィルタを組み合わせることができます。たとえば、マーケティング部門では、サイズの大きな画像ファイルをベンダーレコードとは異なる方法で格納しなければならない場合があります。一方、人事部門では、特定の地域の人事レコードとポリシー情報を一元的に格納する必要があります。この場合、テナントアカウントでフィルタリングするルールを作成して各部門からレコードを分離し、各ルールでフィルタを使用してルールが環境 する特定のタイプのオブジェクトを識別できます。



== ILMルールの配置手順

配置手順は、オブジェクトデータを格納する場所、タイミング、および方法を決定します。ILM ルールには 1 つ以上の配置手順を含めることができます。各配置手順環境 は一定期間です。

配置手順を作成する場合は、次の点に注意

* 最初に、配置手順を開始するタイミングを決定する参照時間を指定します。参照時間には、オブジェクトが取り込まれたとき、オブジェクトがアクセスされたとき、バージョン管理オブジェクトが noncurrent になったとき、またはユーザ定義の時間が含まれます。
* 次に、基準時間を基準にして配置を適用するタイミングを指定します。たとえば、配置は 0 日目から開始し、オブジェクトが取り込まれた時間から 365 日間継続する場合があります。
* 最後に、コピーのタイプ（レプリケーションまたはイレイジャーコーディング）とコピーの格納場所を指定します。たとえば、 2 つのレプリケートコピーを 2 つの異なるサイトに格納できます。


各ルールでは、 1 つの期間に複数の配置を定義し、期間ごとに異なる配置を定義できます。

* 1つの期間に複数の場所にオブジェクトを配置するには、*他のタイプまたは場所を追加*を選択して、その期間に複数の行を追加します。
* 異なる期間の異なる場所にオブジェクトを配置するには、*別の期間を追加*を選択して次の期間を追加します。次に、期間内に 1 行以上の行を指定します。


この例では、Create ILM Ruleウィザードの[Define placements]ページに表示される2つの配置手順を示しています。

image::../media/ilm_rule_multiple_placements_in_single_time_period.png[Grid Manager の ILM の配置画面]

1つ目の配置手順image:../media/icon_number_1.png["アイコン番号1"]には、1年目の2つの行があります。

* 1 行目では、 2 つのデータセンターサイトに 2 つのレプリケートオブジェクトコピーが作成されます。
* 2行目は、すべてのデータセンターサイトを使用して6+3のイレイジャーコーディングコピーを作成します。


2つ目の配置手順ではimage:../media/icon_number_2.png["アイコン番号1"]、1年後に2つのコピーを作成し、それらのコピーを無期限に保持します。

ルールに一連の配置手順を定義する場合は、少なくとも 1 つの配置手順が 0 日目に開始し、定義した期間の間にギャップがないことを確認する必要があります。 そして、最終的な配置手順は無期限またはオブジェクトコピーが不要になるまで継続されます。

ルールの各期間が終了すると、次の期間のコンテンツ配置手順が適用されます。新しいオブジェクトコピーが作成され、不要なコピーは削除されます。



== ILMルールの取り込み動作

取り込み動作は、ルールの手順に従ってオブジェクトコピーがすぐに配置されるか、または中間コピーが作成されて配置手順があとから適用されるかを制御します。ILM ルールでは、次の取り込み動作を使用できます。

* * Balanced * ： StorageGRID は、取り込み時に ILM ルールで指定されたすべてのコピーを作成しようとします。作成できない場合、中間コピーが作成されてクライアントに成功が返されます。可能な場合は、 ILM ルールで指定されたコピーが作成されます。
* * Strict * ： ILM ルールに指定されたすべてのコピーを作成しないと、クライアントに成功が返されません。
* * Dual commit *：StorageGRID はオブジェクトの中間コピーをただちに作成し、クライアントに成功を返します。可能な場合は、 ILM ルールで指定されたコピーが作成されます。


.関連情報
* link:data-protection-options-for-ingest.html["取り込みオプション"]
* link:advantages-disadvantages-of-ingest-options.html["取り込みオプションのメリット、デメリット、および制限事項"]
* link:../s3/consistency.html#how-consistency-and-ILM-rules-interact["整合性とILMルールの相互作用によるデータ保護への影響"]




== ILM ルールの例

たとえば、ILMルールでは次のように指定できます。

* テナントAに属するオブジェクトにのみ適用されます
* それらのオブジェクトのレプリケートコピーを2つ作成し、各コピーを別 々 のサイトに格納します。
* 2つのコピーは「無期限」で保持されます。つまり、StorageGRIDでは自動的に削除されません。これらのオブジェクトは、クライアントの削除要求によって削除されるか、バケットライフサイクルが終了するまで、 StorageGRID によって保持されます。
* 取り込み動作には[Balanced]オプションを使用します。テナントAがオブジェクトをStorageGRID に保存するとすぐに2サイトの配置手順が適用されます。ただし、必要な両方のコピーをすぐに作成できない場合は除きます。
+
たとえば、テナント A がオブジェクトを保存したときにサイト 2 に到達できない場合、 StorageGRID はサイト 1 のストレージノードに 2 つの中間コピーを作成します。サイト 2 が使用可能になると、 StorageGRID はそのサイトで必要なコピーを作成します。



.関連情報
* link:what-storage-pool-is.html["ストレージプールとは"]
* link:what-cloud-storage-pool-is.html["クラウドストレージプールとは"]

