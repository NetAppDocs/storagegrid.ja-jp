---
permalink: maintain/adding-to-or-changing-subnet-lists-on-grid-network.html 
sidebar: sidebar 
keywords: storagegrid, subnet list, grid network 
summary: IP 変更ツールを使用して、グリッドネットワークのサブネットを追加または変更することができます。 
---
= グリッドネットワークのサブネットリストに対する追加または変更
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
IP 変更ツールを使用して、グリッドネットワークのサブネットを追加または変更することができます。

.開始する前に
* あなたはファイルを持ってい `Passwords.txt`ます。


グリッドネットワークサブネットリストで、サブネットの追加、削除、または変更を行うことができます。変更を行うと、グリッド内のすべてのノードでのルーティングに影響します。


NOTE: グリッドネットワークサブネットリストのみを変更する場合は、グリッドマネージャを使用してネットワーク設定の追加または変更を行います。グリッドネットワーク設定問題 が原因でグリッドマネージャにアクセスできない場合、またはグリッドネットワークルーティングの変更とその他のネットワーク変更を同時に実行する場合は、 IP 変更ツールを使用します。

[NOTE]
====
どのノードのグリッド ネットワーク、管理ネットワーク、またはクライアント ネットワークにも、次の IPv4 アドレスを含むサブネットを使用しないでください。

* 192,168,130,101
* 192,168,131,101
* 192,168,130,102
* 192,168,131,102
* 198.51.100.2
* 198.51.100.4


たとえば、どのノードのグリッド ネットワーク、管理ネットワーク、またはクライアント ネットワークにも次のサブネット範囲を使用しないでください。

* 192.168.130.0/24 は、このサブネット範囲に IP アドレス 192.168.130.101 と 192.168.130.102 が含まれているためです。
* 192.168.131.0/24 は、このサブネット範囲に IP アドレス 192.168.131.101 と 192.168.131.102 が含まれているためです。
* 198.51.100.0/24 は、このサブネット範囲に IP アドレス 198.51.100.2 と 198.51.100.4 が含まれているためです。


====
.手順
. プライマリ管理ノードにログインします。
+
.. 次のコマンドを入力します。 `ssh admin@_primary_Admin_Node_IP_`
.. ファイルに記載されているパスワードを入力し `Passwords.txt`ます。
.. 次のコマンドを入力してrootに切り替えます。 `su -`
.. ファイルに記載されているパスワードを入力し `Passwords.txt`ます。


+
rootとしてログインすると、プロンプトがからに `#`変わります `$`。

. 次のコマンドを入力して、IP変更ツールを起動します。 `change-ip`
. プロンプトでプロビジョニングパスフレーズを入力します。
+
メインメニューが表示されます。

+
image::../media/change_ip_tool_main_menu.png[IP 変更ツールの開始画面のスクリーンショット]

. メインメニューで、グリッドネットワークのサブネットを編集するオプションを選択します（オプション * 4 * ）。
+

NOTE: グリッドネットワークサブネットリストに対する変更は、グリッド全体に反映されます。

. 次のいずれかを選択します。
+
--
** サブネットを追加するには、次のコマンドを入力します。 `add CIDR`
** サブネットを削除するには、次のコマンドを入力します。 `del CIDR`
** 次のコマンドを入力して、サブネットのリストを設定します。 `set CIDR`


--
+
--

NOTE: すべてのコマンドで、次の形式で複数のアドレスを入力できます。 `add CIDR, CIDR`

例： `add 172.14.0.0/16, 172.15.0.0/16, 172.16.0.0/16`


TIP: 「上矢印」を使用して以前に入力した値を現在の入力プロンプトに呼び出し、必要に応じて編集することで、入力に必要な量を減らすことができます。

次の入力例では、グリッドネットワークサブネットリストのサブネットを設定しています。

image::../media/change_ip_tool_gnsl_sample_input.gif[説明が付随するスクリーンショット]

--
. 準備ができたら、「 * q * 」と入力してメインメニュー画面に戻ります。変更内容は、クリアまたは適用されるまで保持されます。
. 次のいずれかを選択します。
+
** オプション * 5 * を選択すると、変更された項目のみを表示するために分離された出力に編集内容が表示されます。次の出力例に示すように、変更は緑（追加）または赤（削除）で強調表示されます。
+
image::../media/change_ip_tool_gnsl_sample_output.gif[説明が付随するスクリーンショット]

** オプション * 6 * を選択すると、設定全体を表示する出力に編集内容が表示されます。変更は、緑（追加）または赤（削除）で強調表示されます。
+

NOTE: 一部のコマンドラインインターフェイスでは、追加と削除が取り消し線で示される場合があります。



. オプション * 7 * を選択して、すべての段階的な変更を検証します。
+
この検証により、重複するサブネットを使用するなど、グリッドネットワーク、管理ネットワーク、クライアントネットワークのルールが確実に実行されます。

. 必要に応じて、オプション * 8 を選択してステージングされたすべての変更を保存し、後で戻って変更を続行します。
+
このオプションを使用すると、適用されていない変更を失うことなく、 IP 変更ツールを終了してあとで再起動できます。

. 次のいずれかを実行します。
+
** 新しいネットワーク設定を保存または適用せずにすべての変更をクリアする場合は、オプション * 9 * を選択します。
** 変更を適用し、新しいネットワーク設定をプロビジョニングする準備ができたら、オプション * 10 を選択します。プロビジョニング中に更新が適用されると、次の出力例に示すようにステータスが出力に表示されます。
+
[listing]
----
Generating new grid networking description file...

Running provisioning...

Updating grid network configuration on Name
----


. グリッドネットワークの変更時にオプション * 10 を選択した場合は、次のいずれかのオプションを選択します。
+
** * apply * ：必要に応じて、変更をただちに適用し、各ノードを自動的に再起動します。
+
外部的な変更なしで新しいネットワーク設定が古いネットワーク設定と同時に機能する場合は、 * apply * オプションを使用して、設定の変更を完全に自動化することができます。

** * stage * ：ノードが次回再起動されるときに変更を適用します。
+
新しいネットワーク構成を機能させるためにネットワーク構成を物理的または仮想的に変更する必要がある場合は、 * stage * オプションを使用して影響を受けるノードをシャットダウンし、必要な物理ネットワーク変更を行って、影響を受けるノードを再起動する必要があります。

+

NOTE: stage *オプションを使用する場合は、中断を最小限に抑えるために、ステージング後できるだけ早くノードを再起動してください。

** *cancel*:この時点ではネットワークを変更しないでください。
+
提案した変更がノードの再起動を必要とするかどうかが不明である場合は、ユーザへの影響を最小限に抑えるために変更を延期できます。「 * CANCEL * 」を選択すると、メインメニューに戻り、変更内容が保持されるので、後で適用できます。



+
変更を適用またはステージングすると、グリッド設定が変更された結果として新しいリカバリパッケージが生成されます。

. エラーが原因で設定が停止した場合は、次のオプションを使用できます。
+
** IP変更手順 を終了してメインメニューに戻るには、「* a *」と入力します。
** 失敗した処理を再試行するには、「 * r * 」と入力します。
** 次の処理に進むには、 * c * と入力します。
+
失敗した処理は、メインメニューからオプション * 10 * （変更の適用）を選択することで後で再試行できます。すべての処理が正常に完了するまで、 IP 変更手順 は完了しません。

** 手動での介入（ノードのリブートなど）が必要なときに、ツールでは失敗と判断された操作が実際には正常に完了したことがわかった場合は、「 * f * 」と入力してその操作を成功とマークし、次の処理に進みます。


. Grid Manager から新しいリカバリパッケージをダウンロードします。
+
.. [* maintenance * （メンテナンス） ] > [* System * （システム * ） ] > [* Recovery packツケ （リカバリパッケージ * ）
.. プロビジョニングパスフレーズを入力します。


+

CAUTION: リカバリパッケージファイルには StorageGRID システムからデータを取得するための暗号キーとパスワードが含まれているため、安全に保管する必要があります。


