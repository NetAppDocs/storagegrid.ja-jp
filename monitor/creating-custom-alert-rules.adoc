---
permalink: monitor/creating-custom-alert-rules.html 
sidebar: sidebar 
keywords: how to create custom alert rules 
summary: カスタムのアラートルールを作成して、アラートをトリガーする条件を独自に定義することができます。 
---
= カスタムのアラートルールを作成
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
カスタムのアラートルールを作成して、アラートをトリガーする条件を独自に定義することができます。

.開始する前に
* Grid Managerにサインインしておきますlink:../admin/web-browser-requirements.html["サポートされている Web ブラウザ"]。
* あなたはを持っていますlink:../admin/admin-group-permissions.html["アラートまたはRoot Access権限を管理します。"]。
* に精通しているlink:commonly-used-prometheus-metrics.html["よく使用される Prometheus 指標"]必要があります。
* を理解する https://prometheus.io/docs/prometheus/latest/querying/basics/["Prometheus クエリの構文"^]必要があります。
* オプションとして、ビデオを視聴しました:
+
.カスタムアラート
video::54af90c4-9a38-4136-9621-b1ff008604a3[panopto]


.タスクの内容
StorageGRID はカスタムアラートを検証しません。カスタムのアラートルールを作成する場合は、次の一般的なガイドラインに従ってください。

* デフォルトのアラートルールの条件を参考に、カスタムのアラートルールを作成します。
* アラートルールに複数の条件を定義する場合は、すべての条件に同じ式を使用します。その後、各条件のしきい値を変更します。
* 各条件に入力ミスやロジックエラーがないか、慎重にチェックしてください。
* Grid 管理 API にリストされている指標のみを使用してください。
* グリッド管理APIを使用して式をテストする場合、「successful」応答は空の応答本文（アラートがトリガーされない）である可能性があることに注意してください。アラートが実際にトリガーされるかどうかを確認するには、現在 true になるしきい値を一時的に設定します。
+
たとえば、式をテストするには `node_memory_MemTotal_bytes < 24000000000`、まずを実行し `node_memory_MemTotal_bytes >= 0`、予期した結果が得られることを確認します（すべてのノードが値を返します）。次に、演算子としきい値を目的の値に戻して再実行します。結果がない場合は、この式に対するアラートが現在発生していません。

* アラートが想定どおりにトリガーされることを確認していないかぎり、カスタムアラートが機能しているとは思わないでください。


.手順
. *アラート* > *ルール*を選択します。
+
[Alert Rules] ページが表示されます。

. [ * カスタムルールの作成 * ] を選択します。
+
[Create Custom Rule] ダイアログボックスが表示されます。

+
image::../media/alerts_create_custom_rule.png[アラート > カスタムルールを作成]

. [有効]*チェックボックスをオンまたはオフにして、このアラートルールが現在有効になっているかどうかを確認します。
+
アラートルールを無効にすると、ルールの式は評価されず、アラートはトリガーされません。

. 次の情報を入力します。
+
[cols="1a,2a"]
|===
| フィールド | 製品説明 


 a| 
一意の名前
 a| 
このルールの一意の名前。アラートルール名は、 [Alerts] ページに表示され、電子メール通知の件名にもなります。アラートルールの名前は 1~64 文字で指定できます。



 a| 
製品説明
 a| 
発生している問題の概要 。概要 は、アラートページおよび E メール通知に表示されるアラートメッセージです。アラートルールの説明は、 1~128 文字で指定できます。



 a| 
推奨される対処方法
 a| 
必要に応じて、このアラートがトリガーされたときに実行する推奨される対処方法を指定します。推奨される対処方法をプレーンテキスト（書式コードなし）で入力します。アラートルールの推奨される対処方法は、 0~1 、 024 文字で指定できます。

|===
. Conditions セクションで、アラートの重大度レベルを 1 つ以上指定する Prometheus 式を入力します。
+
基本式は、通常、次の形式で指定します。

+
`[metric] [operator] [value]`

+
式の文字数に制限はありませんが、ユーザインターフェイスでは 1 行で表示されます。少なくとも 1 つの式が必要です。

+
次の式では、あるノードに搭載された RAM の容量が 24 、 000 、 000 、 000 バイト（ 24GB ）未満である場合にアラートがトリガーされます。

+
`node_memory_MemTotal_bytes < 24000000000`

+
使用可能な指標を確認し、Prometheus式をテストするには、ヘルプアイコンを選択しimage:../media/icon_nms_question.png["疑問符アイコン"]、グリッド管理APIの[Metrics]セクションへのリンクをクリックします。

. [ * 期間 * ] フィールドに、アラートがトリガーされるまでに条件を継続的に有効にしておく必要がある期間を入力し、時間の単位を選択します。
+
条件が true になったときにすぐにアラートをトリガーするには、「 * 0 * 」と入力します。一時的な状況でアラートがトリガーされないようにするには、この値を大きくし

+
デフォルトは5分です。

. [ 保存（ Save ） ] を選択します。
+
ダイアログボックスが閉じ、新しいカスタムアラートルールがアラートルールテーブルに表示されます。


