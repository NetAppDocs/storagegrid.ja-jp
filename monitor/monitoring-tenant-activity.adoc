---
permalink: monitor/monitoring-tenant-activity.html 
sidebar: sidebar 
keywords: how to monitor tenant activity 
summary: S3クライアントアクティビティはすべてStorageGRIDテナントアカウントに関連付けられます。Grid Managerを使用して、すべてのテナントまたは特定のテナントのストレージ使用量またはネットワークトラフィックを監視できます。監査ログまたはGrafanaダッシュボードを使用して、テナントによるStorageGRID の使用状況に関する詳細情報を収集できます。 
---
= テナントのアクティビティを監視する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
S3クライアントアクティビティはすべてStorageGRIDテナントアカウントに関連付けられます。Grid Managerを使用して、すべてのテナントまたは特定のテナントのストレージ使用量またはネットワークトラフィックを監視できます。監査ログまたはGrafanaダッシュボードを使用して、テナントによるStorageGRID の使用状況に関する詳細情報を収集できます。

.開始する前に
* Grid Managerにサインインしておきますlink:../admin/web-browser-requirements.html["サポートされている Web ブラウザ"]。
* あなたはを持っていますlink:../admin/admin-group-permissions.html["rootアクセスまたはテナントアカウントの権限"]。




== すべてのテナントを表示します

[Tenants]ページには、現在のすべてのテナントアカウントの基本情報が表示されます。

.手順
. *テナント*を選択します。
. [Tenant]ページに表示される情報を確認します。
+
テナントごとに、使用済みの論理スペース、クォータ使用量、クォータ、およびオブジェクト数が表示されます。テナントにクォータが設定されていない場合は、[クォータ使用量]フィールドと[クォータ]フィールドにダッシュ（&#8212;）が表示されます。

+

NOTE: このテナントに属するすべてのオブジェクトの論理サイズには、未完了および進行中のマルチパートアップロードが含まれます。このサイズには、ILM ポリシーに使用される追加の物理スペースは含まれません。使用済みスペースの値は推定値です。これらの見積りは、取り込みのタイミング、ネットワーク接続、およびノードの状態によって影響を受けます。

+
image::../media/tenant_accounts_page.png[テナントアカウントヘエシ]

. 必要に応じて、*[Sign in/Copy URL]*列のサインインリンクを選択してテナントアカウントにサインインしimage:../media/icon_tenant_sign_in.png["テナントのサインインアイコン"]ます。
. 必要に応じて、[サインイン/ URLのコピー]列の[URLのコピー]リンクを選択して、テナントのサインインページのURLをコピーしimage:../media/icon_tenant_copy_url.png["テナントコピー URL のアイコン"]ます。
. 必要に応じて、*[CSVにエクスポート]*を選択して、すべてのテナントの使用状況の値を含むファイルを表示およびエクスポートし `.csv`ます。
+
ファイルを開くか保存するかを確認するメッセージが表示されます `.csv`。

+
ファイルの内容は `.csv`次の例のようになります。

+
image::../media/tenant_accounts_example_csv.png[テナントアカウントの例： .csv]

+
ファイルはスプレッドシートアプリケーションで開くことも、自動化で使用することもできます `.csv`。

. オブジェクトが表示されない場合は、必要に応じて*[操作]*>*[削除]*を選択してテナントを削除します。を参照して link:../admin/deleting-tenant-account.html["テナントアカウントを削除する"]
+
バケットまたはコンテナが含まれているテナントアカウントは削除できません。





== 特定のテナントを表示します

特定のテナントの詳細を表示できます。

.手順
. [Tenants]ページでテナント名を選択します。
+
テナントの詳細ページが表示されます。

+
image::../media/tenant_usage_modal.png[テナント使用モード]

. ページ上部のテナントの概要を確認します。
+
詳細ページのこのセクションには、テナントのオブジェクト数、クォータ使用量、使用済み論理スペース、クォータの設定など、テナントの概要情報が表示されます。

+

NOTE: このテナントに属するすべてのオブジェクトの論理サイズには、未完了および進行中のマルチパートアップロードが含まれます。このサイズには、ILM ポリシーに使用される追加の物理スペースは含まれません。使用済みスペースの値は推定値です。これらの見積りは、取り込みのタイミング、ネットワーク接続、およびノードの状態によって影響を受けます。

. [スペースの内訳]タブで、*[スペースの消費]*グラフを確認します。
+
このグラフには、テナントのすべてのS3バケットの合計スペース消費量が表示されます。

+
このテナントにクォータが設定されている場合は、クォータの使用済み容量と残り容量がテキストで表示されます（例： `85.00 GB of 100 GB used`）。クォータが設定されていない場合、テナントのクォータは無制限で、テキストには使用済みスペースの量（など）のみが含まれます `85.00 GB used`。棒グラフは、各バケットまたはコンテナのクォータの割合を示します。テナントがストレージクォータを 1% 以上かつ 1GB 以上超過した場合は、クォータの総容量と超過容量がグラフに表示されます。

+
棒グラフにカーソルを合わせると、各バケットまたはコンテナで使用されるストレージを確認できます。空きスペースセグメントにカーソルを合わせると、残りのストレージクォータを確認できます。

+
image::../media/tenant_bucket_space_consumption_GM.png[テナントバケットの消費バーグラフ]

+

CAUTION: クォータ使用量は内部の見積もりに基づいており、場合によっては超過する可能性があります。たとえば、テナントがクォータを超えた場合、 StorageGRID はテナントがオブジェクトのアップロードを開始したときにクォータをチェックし、新しい取り込みを拒否します。ただし、 StorageGRID では、クォータを超過したかどうかを判断する際に、現在のアップロードのサイズは考慮されません。オブジェクトが削除されると、クォータ使用量が再計算されるまでテナントが新しいオブジェクトを一時的にアップロードできなくなることがあります。クォータ使用量の計算には10分以上かかることがあります。

+

NOTE: テナントのクォータ使用量は、テナントがStorageGRIDにアップロードしたオブジェクトデータの総容量（論理サイズ）を示します。クォータ使用量は、それらのオブジェクトのコピーとメタデータの格納に使用されているスペース（物理サイズ）ではありません。

+

NOTE: 「* Tenant quota usage high *」アラートルールを有効にすると、テナントがクォータを消費しているかどうかを確認できます。有効にすると、テナントのクォータの 90% が使用されたときにこのアラートがトリガーされます。手順については、を参照してくださいlink:../monitor/editing-alert-rules.html["アラートルールを編集"]。

. [Space breakdown（スペース内訳）]*タブで、*[Bucket details（バケットの詳細）]*を確認します。
+
次の表に、テナントのS3バケットを示します。使用済みスペースは、バケットまたはコンテナ内のオブジェクトデータの総容量です。この値は、 ILM コピーとオブジェクトメタデータに必要なストレージスペースを表しているわけではありません。

. 必要に応じて、「 * Export to CSV * 」を選択し、各バケットまたはコンテナの使用量の値を含む .csv ファイルを表示してエクスポートします。
+
個 々 のS3テナントのファイルの内容は `.csv`次の例のようになります。

+
image::../media/tenant_bucket_details_csv.png[テナントバケットの詳細の CSV の例]

+
ファイルはスプレッドシートアプリケーションで開くことも、自動化で使用することもできます `.csv`。

. 必要に応じて、* Allowed features *タブを選択して、テナントに対して有効になっている権限と機能のリストを表示します。これらの設定のいずれかを変更する必要があるかどうかを確認しますlink:../admin/editing-tenant-account.html["テナントアカウントを編集します"]。
. テナントに* Use grid federation connection *権限がある場合は、必要に応じて* Grid federation *タブを選択して接続の詳細を確認します。
+
およびを参照してくださいlink:../admin/grid-federation-overview.html["グリッドフェデレーションとは"]link:../admin/grid-federation-manage-tenants.html["グリッドフェデレーションに許可されたテナントを管理します"]。





== ネットワークトラフィックを表示します

テナントにトラフィック分類ポリシーが設定されている場合は、そのテナントのネットワークトラフィックを確認します。

.手順
. *構成* > *ネットワーク* > *トラフィック分類*を選択します。
+
[Traffic Classification Policies] ページが表示され、既存のポリシーがテーブルにリストされます。

. ポリシーのリストを確認して、特定のテナントに適用されるポリシーを特定します。
. ポリシーに関連付けられている指標を表示するには、ポリシーの左側にあるラジオボタンを選択し、*[Metrics]*を選択します。
. グラフを分析して、ポリシーがトラフィックを制限している頻度と、ポリシーを調整する必要があるかどうかを判断します。


詳細については、を参照してください link:../admin/managing-traffic-classification-policies.html["トラフィック分類ポリシーを管理します"] 。



== 監査ログを使用します

必要に応じて、監査ログを使用してテナントのアクティビティをより詳細に監視できます。

たとえば、次の種類の情報を監視できます。

* PUT 、 GET 、 DELETE など、特定のクライアント処理
* オブジェクトサイズ
* オブジェクトに適用されている ILM ルール
* クライアント要求の送信元 IP


監査ログは、選択したログ分析ツールを使用して分析可能なテキストファイルに書き込まれます。これにより、クライアントアクティビティをよりよく理解したり、高度なチャージバックおよび課金モデルを実装したりできます。

詳細については、を参照してください link:../audit/index.html["監査ログを確認します"] 。



== Prometheus指標を使用

必要に応じて、Prometheus指標を使用してテナントアクティビティをレポートします。

* グリッド マネージャーで、[サポート] > [ツール] > [メトリック] を選択します。  S3 概要などの既存のダッシュボードを使用して、クライアントのアクティビティを確認できます。
+

NOTE: Metrics ページで使用できるツールは、主にテクニカルサポートが使用することを目的としています。これらのツールの一部の機能およびメニュー項目は、意図的に機能しないようになっています。

* Grid Managerの上部でヘルプアイコンを選択し、*[API documentation]*を選択します。グリッド管理 API の指標セクションの指標を使用して、テナントアクティビティ用のカスタムのアラートルールとダッシュボードを作成できます。


詳細については、を参照してください link:reviewing-support-metrics.html["サポート指標を確認"] 。
